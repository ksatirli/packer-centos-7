{
  "builders": [
    {
      "type": "amazon-ebs",

      "ami_description": "{{ user `ami_description` }}",
      "ami_name": "{{ user `ami_name` }}-{{ user `timestamp` }}",
      "instance_type": "{{ user `instance_type` }}",
      "region": "{{ user `region` }}",
      "source_ami": "{{ user `source_ami` }}",
      "spot_price": "{{ user `spot_price` }}",
      "spot_price_auto_product": "{{ user `spot_price_auto_product` }}",
      "ssh_pty": "{{ user `ssh_pty` }}",
      "ssh_timeout": "{{ user `ssh_timeout` }}",
      "ssh_username": "{{ user `ssh_username` }}",
      "tags": {
        "Name": "{{ user `ami_name` }}"
      },
      "user_data_file": "{{ user `user_data_file` }}"
    }
  ],

  "provisioners": [
    {
      "type": "ansible",
      "user": "{{ user `ssh_username` }}",
      "sftp_command": "{{ user `sftp_command` }}",
      "playbook_file": "{{ user `playbook_file` }}",
      "groups": [
        "packer"
      ],
      "extra_arguments": [
        "-{{ user `ansible_verbosity_level` }}",
        "--skip-tags={{ user `ansible_tags_skip` }}",
      ]
    }
  ]

}
